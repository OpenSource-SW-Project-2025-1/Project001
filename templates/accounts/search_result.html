{% extends 'base.html' %}
{% load static %}
{% block content %}
{% include 'accounts/menu.html' %}

<main class="main">

  <!-- 검색창 -->
<div class="search-container">
  <form action="/search_result/" method="get" class="search-form">
    <input type="text" name="query" placeholder="검색어를 입력하세요" value="{{ query|default:'' }}" class="search-input" required>
    <button type="submit" class="search-btn">🔍</button>
  </form>
</div>
<!--css 수정 -->
      <style>
    body {
      background-color: #a5dff6; /* 연한 하늘색 배경 */
      font-family: sans-serif;
    }

    .keyword-container {
      background-color: white;
      border-radius: 10px;
      padding: 20px;
      max-width: 90%;      
      width: 600px;
      margin: 50px auto;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      box-sizing: border-box;
    }

    .keyword-title {
      font-weight: bold;
      margin-bottom: 10px;
    }

    .keyword-line {
      border-bottom: 1px solid black;
      margin-bottom: 15px;
    }

    .keyword-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      overflow-x: hidden;
    }

    .keyword-button {
      border: 1px solid black;
      padding: 5px 15px;
      background-color: white;
      cursor: pointer;
      transition: background-color 0.2s;
    }

    .keyword-button:hover {
      background-color: #e0f0ff;
    }
  </style>
</head>
<body>

<div class="keyword-container">
  <div class="keyword-title"># 키워드 검색</div>
  <div class="keyword-line"></div>
    <form id="keywordForm" method="get" action="/accounts/run-api/">
        <input type="hidden" name="ThemaArray" id="ThemaInput">
        <button type="submit" id="submitBtn" style="display: none;">Submit</button>
    </form>
  <div class="keyword-buttons">
    <!-- 예시로 키워드 15개 -->
      <div class="keyword-button" data-keyword="010">신체건강</div>
      <div class="keyword-button" data-keyword="020">정신건강</div>
      <div class="keyword-button" data-keyword="030">생활지원</div>
      <div class="keyword-button" data-keyword="040">주거</div>
      <div class="keyword-button" data-keyword="050">일자리</div>
      <div class="keyword-button" data-keyword="060">문화▪여가</div>
      <div class="keyword-button" data-keyword="070">안전▪위기</div>
      <div class="keyword-button" data-keyword="080">임신▪출산</div>
      <div class="keyword-button" data-keyword="090">보육</div>
      <div class="keyword-button" data-keyword="100">교육</div>
      <div class="keyword-button" data-keyword="110">입양▪위탁</div>
      <div class="keyword-button" data-keyword="120">보호▪돌봄</div>
      <div class="keyword-button" data-keyword="130">서민금융</div>
      <div class="keyword-button" data-keyword="140">법률</div>
      <div class="keyword-button" data-keyword="160">에너지</div>
  </div>
</div>
<script>
    document.querySelectorAll('.keyword-button').forEach(function(button) {
      button.addEventListener('click', function() {
        const intrsThemaArray = this.dataset.keyword;
        document.getElementById('ThemaInput').value = intrsThemaArray;
        document.getElementById('submitBtn').click();  // 자동 제출
      });
    });
</script>
</body>

  <!-- 키워드 정렬 선택 -->
  <section class="section-new">
    <div class="section-header">
      <h3 class="section-title">검색 결과</h3>
      <div class="dropdown">
        <button class="more-btn">정렬 ▾</button>
        <!-- 정렬 드롭다운 옵션 추가 예정 -->
      </div>
    </div>

    <!-- 카드 목록 -->
    <div class="card-container">
      {% for item in results %}
      <div class="card">
        <div class="card-header">
          <span class="tag">{{ item.category|default:"분류 없음" }}</span>
        </div>
        <div class="title">{{ item.title }}</div>
        <div class="desc">{{ item.description }}</div>

        <!-- detail 링크 임시 처리 -->
        <a href="{% url 'welfare_info' %}" class="detail-btn">+ 자세히보기</a>

        <div class="keywords">
          {% if item.keywords %}
            {% for keyword in item.keywords %}
              <span>#{{ keyword }}</span>
            {% endfor %}
          {% else %}
            <span style="color:#888;">#추천 없음</span>
          {% endif %}
        </div>
      </div>
      {% empty %}
      <p style="text-align:center; color:#555;">검색 결과가 없습니다.</p>
      {% endfor %}
    </div>
  </section>

  <!-- 페이지네이션 -->
  {% if page_range %}
  <div class="pagination" style="margin-top: 40px; text-align: center;">
    <span class="page-link">처음</span>
    {% for i in page_range %}
      <span class="page-link {% if i == current_page %}active{% endif %}">{{ i }}</span>
    {% endfor %}
    <span class="page-link">마지막</span>
  </div>
  {% endif %}
</main>
    


{% endblock %}
